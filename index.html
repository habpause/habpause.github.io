<html>
    <head>
        
    </head>
    <body>  
        
        <h1>Habbo Umbaupause Überwacher (hetero)</h1>
        <p>Hallo du Hetero Mensch (nicht gay)!</p>
        <p>Du möchtest wissen wann die Habbo.de Umbaupause zu Ende ist?</p>
        <p>Drücke einfach auf diesen Button und erlaube der Webseite, Benachrichtigayungen zu senden. Dann wirst du automatisch informiert, wenn die Umbaupause vorbei ist!</p>
        <button id="enable" onclick="askNotificationPermission()">Starte Überwachung</button>
        <script>

            async function askNotificationPermission() {
                document.querySelector('#enable').disabled = true;
                
                // Check if the browser supports notifications
                if (!("Notification" in window)) {
                    console.log("Du bist eine extremst schwule Schwuchtel wenn du das liest.");
                    document.querySelector('#enable').innerText = "Dein schwuler Browser unterstützt keine Benachrichtigungen. Das geht nur an heterosexuellen Geräten. Benutz Firefox am PC du Schwuchtel.";
                    return;
                }

                Notification.requestPermission().then((permission) => {
                    // set the button to shown or hidden, depending on what the user answers
                    console.log(`Notifications API permission set to ${permission}`);
                    
                    document.querySelector('#enable').innerText = "Überwachung läuft. Du wirst benachrichtigt, sobald die Umbaupause vorbei ist.";
                    
                    const intervalId = setInterval(async _ => {
                        const response = await fetch("https://www.habbo.de/habbo-imaging/avatarimage?user=Clepsidra&headonly=1&size=b&gesture=sml&direction=2&head_direction=2&action=std");
                        if (!response.ok) {
                            console.log("DOWN");
                        } else {
                            console.log("UP");
                            clearInterval(intervalId);
                            const notification = new Notification("Habbo Umbaupause Überwacher (hetero)", { body: "HETERO! HABBO GEHT WIEDER!" }); 
                        }

                        console.log("INTERVAL");
                    }, 30000);
                });

                
            }

        </script>
    </body>
</html>
